"use strict";"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})});var checkPendingReviews=function(){DBHelper.openIDB().then(function(e){if(e)return e.transaction("pending-reviews","readwrite").objectStore("pending-reviews").getAll()}).then(function(e){e.forEach(function(e){DBHelper.deletePendingReviewFromIdb(e),DBHelper.storeReview(e,function(e){console.log("submiting pending reviews")})})})},checkPendingFavorites=function(){DBHelper.openIDB().then(function(e){if(e)return e.transaction(DB_NAME,"readwrite").objectStore(DB_NAME).getAll()}).then(function(e){e.forEach(function(e){"true"!=e.is_favorite_pending&&1!=e.is_favorite_pending||DBHelper.submitRestaurantPendingFavorites(e)})})};window.addEventListener("offline",function(e){console.log("offline")}),window.addEventListener("online",function(e){console.log("online"),checkPendingReviews(),checkPendingFavorites()});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).raterJs=e()}}(function(){return function o(a,u,s){function c(n,e){if(!u[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=u[n]={exports:{}};a[n][0].call(i.exports,function(e){var t=a[n][1][e];return c(t||e)},i,i.exports,o,a,u,s)}return u[n].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}({1:[function(e,t,n){e("./style.css");t.exports=function(e){var o=!0;if(void 0===e.element||null===e.element)throw new Error("element required");if(void 0!==e.showToolTip&&(o=!!e.showToolTip),void 0!==e.step&&(e.step<=0||1<e.step))throw new Error("step must be a number between 0 and 1");var a,t,u=e.max||5,n=e.starSize||16,s=e.step||1,c=e.onHover,r=e.onLeave,l=e.element;l.classList.add("star-rating");var i=document.createElement("div");i.classList.add("star-value"),i.style.backgroundSize=n+"px",l.appendChild(i),l.style.width=n*u+"px",l.style.height=n+"px",l.style.backgroundSize=n+"px";var d,f,p,m=e.rateCallback,v=!!e.readOnly,g=!1,h=e.isBusyText;if(d=void 0!==e.disableText?e.disableText:"{rating}/{maxRating}",p=void 0!==e.ratingText?e.ratingText:"{rating}/{maxRating}",e.rating)x(e.rating);else{var y=l.dataset.rating;y&&x(+y)}function w(e){if(!0!==v&&!0!==g){var t=e.offsetX/l.offsetWidth*100;if(t<101){if(1===s)f=Math.ceil(t/100*u);else for(var n=t/100*u,r=0;;r+=s)if(n<=r){f=r;break}if(l.querySelector(".star-value").style.width=f/u*100+"%",o){var i=p.replace("{rating}",f);i=i.replace("{maxRating}",u),l.setAttribute("data-title",i)}"function"==typeof c&&c(f,a)}}}function b(e){void 0!==a?(l.querySelector(".star-value").style.width=a/u*100+"%",l.setAttribute("data-rating",a)):(l.querySelector(".star-value").style.width="0%",l.removeAttribute("data-rating")),"function"==typeof r&&r(f,a)}function A(e){!0!==v&&!0!==g&&void 0!==m&&(g=!0,t=f,void 0===h?l.removeAttribute("data-title"):l.setAttribute("data-title",h),m.call(this,t,function(){!1===v&&l.removeAttribute("data-title"),g=!1}))}function I(){if(v=!0,o&&d){var e=d.replace("{rating}",a);e=e.replace("{maxRating}",u),l.setAttribute("data-title",e)}else l.removeAttribute("data-title")}function x(e){if(void 0===e)throw new Error("Value not set.");if("number"!=typeof e)throw new Error("Value must be a number.");if(e<0||u<e){var t=new Error("Value too high. Please set a rating of "+u+" or below.");throw t.name="ratingError",t}a=e,l.querySelector(".star-value").style.width=e/u*100+"%",l.setAttribute("data-rating",e)}void 0===a&&(l.querySelector(".star-value").style.width="0px"),v&&I(),l.addEventListener("mousemove",w),l.addEventListener("mouseleave",b);var D={setRating:x,getRating:function(){return a},disable:I,enable:function(){v=!1,l.removeAttribute("data-title")},dispose:function(){l.removeEventListener("mousemove",w),l.removeEventListener("mouseleave",b),l.removeEventListener("click",A)}};return l.addEventListener("click",A.bind(D)),D}},{"./style.css":2}],2:[function(e,t,n){var r=".star-rating {\n  width: 0;\n  position: relative;\n  display: inline-block;\n  background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDguOSIgaGVpZ2h0PSIxMDMuNiIgdmlld0JveD0iMCAwIDEwOC45IDEwMy42Ij48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6I2UzZTZlNjt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPnN0YXJfMDwvdGl0bGU+PGcgaWQ9IkxheWVyXzIiIGRhdGEtbmFtZT0iTGF5ZXIgMiI+PGcgaWQ9IkxheWVyXzEtMiIgZGF0YS1uYW1lPSJMYXllciAxIj48cG9seWdvbiBjbGFzcz0iY2xzLTEiIHBvaW50cz0iMTA4LjkgMzkuNiA3MS4zIDM0LjEgNTQuNCAwIDM3LjYgMzQuMSAwIDM5LjYgMjcuMiA2Ni4xIDIwLjggMTAzLjYgNTQuNCA4NS45IDg4LjEgMTAzLjYgODEuNyA2Ni4xIDEwOC45IDM5LjYiLz48L2c+PC9nPjwvc3ZnPgo=);\n  background-position: 0 0;\n  background-repeat: repeat-x;\n  cursor: pointer;\n}\n.star-rating[data-title]:hover:after {\n  content: attr(data-title);\n  padding: 4px 8px;\n  color: #333;\n  position: absolute;\n  left: 0;\n  top: 100%;\n  z-index: 20;\n  white-space: nowrap;\n  -moz-border-radius: 5px;\n  -webkit-border-radius: 5px;\n  border-radius: 5px;\n  -moz-box-shadow: 0px 0px 4px #222;\n  -webkit-box-shadow: 0px 0px 4px #222;\n  box-shadow: 0px 0px 4px #222;\n  background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);\n  background-image: -webkit-gradient(linear,left top,left bottom,color-stop(0, #eeeeee),color-stop(1, #cccccc));\n  background-image: -webkit-linear-gradient(top, #eeeeee, #cccccc);\n  background-image: -moz-linear-gradient(top, #eeeeee, #cccccc);\n  background-image: -ms-linear-gradient(top, #eeeeee, #cccccc);\n  background-image: -o-linear-gradient(top, #eeeeee, #cccccc);\n}\n.star-rating .star-value {\n  height: 100%;\n  position: absolute;\n}\n.star-rating .star-value {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background: url('data:image/svg+xml;base64,PHN2ZwoJeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTA4LjkiIGhlaWdodD0iMTAzLjYiIHZpZXdCb3g9IjAgMCAxMDguOSAxMDMuNiI+Cgk8ZGVmcz4KCQk8c3R5bGU+LmNscy0xe2ZpbGw6I2YxYzk0Nzt9PC9zdHlsZT4KCTwvZGVmcz4KCTx0aXRsZT5zdGFyMTwvdGl0bGU+Cgk8ZyBpZD0iTGF5ZXJfMiIgZGF0YS1uYW1lPSJMYXllciAyIj4KCQk8ZyBpZD0iTGF5ZXJfMS0yIiBkYXRhLW5hbWU9IkxheWVyIDEiPgoJCQk8cG9seWdvbiBjbGFzcz0iY2xzLTEiIHBvaW50cz0iNTQuNCAwIDcxLjMgMzQuMSAxMDguOSAzOS42IDgxLjcgNjYuMSA4OC4xIDEwMy42IDU0LjQgODUuOSAyMC44IDEwMy42IDI3LjIgNjYuMSAwIDM5LjYgMzcuNiAzNC4xIDU0LjQgMCIvPgoJCTwvZz4KCTwvZz4KPC9zdmc+Cg==');\n  background-repeat: repeat-x;\n}\n";e("browserify-css").createStyle(r,{href:"lib\\style.css"},{insertAt:"bottom"}),t.exports=r},{"browserify-css":3}],3:[function(e,t,n){var i=[],a=function(e,t){var n=document.head||document.getElementsByTagName("head")[0],r=i[i.length-1];if((t=t||{}).insertAt=t.insertAt||"bottom","top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),i.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}};t.exports={createLink:function(e,t){var n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("link");for(var i in r.href=e,r.rel="stylesheet",t)if(t.hasOwnProperty(i)){var o=t[i];r.setAttribute("data-"+i,o)}n.appendChild(r)},createStyle:function(e,t,n){n=n||{};var r=document.createElement("style");for(var i in r.type="text/css",t)if(t.hasOwnProperty(i)){var o=t[i];r.setAttribute("data-"+i,o)}r.sheet?(r.innerHTML=e,r.sheet.cssText=e,a(r,{insertAt:n.insertAt})):r.styleSheet?(a(r,{insertAt:n.insertAt}),r.styleSheet.cssText=e):(r.appendChild(document.createTextNode(e)),a(r,{insertAt:n.insertAt}))}}},{}]},{},[1])(1)}),function(){function a(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function o(n,r,i){var o,e=new Promise(function(e,t){a(o=n[r].apply(n,i)).then(e,t)});return e.request=o,e}function e(e,n,t){t.forEach(function(t){Object.defineProperty(e.prototype,t,{get:function(){return this[n][t]},set:function(e){this[n][t]=e}})})}function t(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return o(this[n],e,arguments)})})}function n(t,n,r,e){e.forEach(function(e){e in r.prototype&&(t.prototype[e]=function(){return this[n][e].apply(this[n],arguments)})})}function r(e,r,t,n){n.forEach(function(n){n in t.prototype&&(e.prototype[n]=function(){return e=this[r],(t=o(e,n,arguments)).then(function(e){if(e)return new u(e,t.request)});var e,t})})}function i(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function c(n){this._tx=n,this.complete=new Promise(function(e,t){n.oncomplete=function(){e()},n.onerror=function(){t(n.error)},n.onabort=function(){t(n.error)}})}function l(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new c(n)}function d(e){this._db=e}e(i,"_index",["name","keyPath","multiEntry","unique"]),t(i,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),r(i,"_index",IDBIndex,["openCursor","openKeyCursor"]),e(u,"_cursor",["direction","key","primaryKey","value"]),t(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(u.prototype[n]=function(){var t=this,e=arguments;return Promise.resolve().then(function(){return t._cursor[n].apply(t._cursor,e),a(t._request).then(function(e){if(e)return new u(e,t._request)})})})}),s.prototype.createIndex=function(){return new i(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new i(this._store.index.apply(this._store,arguments))},e(s,"_store",["name","keyPath","indexNames","autoIncrement"]),t(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),r(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),n(s,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},e(c,"_tx",["objectStoreNames","mode"]),n(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},e(l,"_db",["name","version","objectStoreNames"]),n(l,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},e(d,"_db",["name","version","objectStoreNames"]),n(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(o){[s,i].forEach(function(e){o in e.prototype&&(e.prototype[o.replace("open","iterate")]=function(){var e,t=(e=arguments,Array.prototype.slice.call(e)),n=t[t.length-1],r=this._store||this._index,i=r[o].apply(r,t.slice(0,-1));i.onsuccess=function(){n(i.result)}})})}),[i,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,n){var r=this,i=[];return new Promise(function(t){r.iterateCursor(e,function(e){e?(i.push(e.value),void 0===n||i.length!=n?e.continue():t(i)):t(i)})})})});var f={open:function(e,t,n){var r=o(indexedDB,"open",[e,t]),i=r.request;return i&&(i.onupgradeneeded=function(e){n&&n(new l(i.result,e.oldVersion,i.transaction))}),r.then(function(e){return new d(e)})},delete:function(e){return o(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=f,module.exports.default=module.exports):self.idb=f}();var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var map,DB_NAME="restaurantsDB",isChrome=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),DBHelper=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"openIDB",value:function(){return navigator.serviceWorker?idb.open(DB_NAME,1,function(e){e.createObjectStore(DB_NAME,{keyPath:"id"}).createIndex("by-id","id"),e.createObjectStore("pending-reviews",{keyPath:"random_id"}),e.createObjectStore("reviews",{keyPath:"id"})}):Promise.resolve()}},{key:"saveToIDB",value:function(r){return a.openIDB().then(function(e){if(e){var t=e.transaction(DB_NAME,"readwrite"),n=t.objectStore(DB_NAME);return r.forEach(function(e){n.put(e)}),t.complete}}).catch(function(e){console.log("DB open failed",e)})}},{key:"getCachedRestaurants",value:function(){return a.openIDB().then(function(e){if(e)return e.transaction(DB_NAME).objectStore(DB_NAME).getAll()})}},{key:"fetchRestaurants",value:function(){return fetch(a.DATABASE_URL+"/restaurants").then(function(e){return e.json()}).then(function(e){return a.saveToIDB(e),e}).catch(function(e){throw"Request failed. Returned status of "+e})}},{key:"getRestaurants",value:function(t){return a.getCachedRestaurants().then(function(e){return e.length?Promise.resolve(e):a.fetchRestaurants()}).then(function(e){t(null,e)}).catch(function(e){t(e,null)})}},{key:"fetchRestaurantById",value:function(r,i){a.getRestaurants(function(e,t){if(e)i(e,null);else{var n=t.find(function(e){return e.id==r});n?i(null,n):i("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(r,i){a.getRestaurants(function(e,t){if(e)i(e,null);else{var n=t.filter(function(e){return e.cuisine_type==r});i(null,n)}})}},{key:"fetchRestaurantByNeighborhood",value:function(r,i){a.getRestaurants(function(e,t){if(e)i(e,null);else{var n=t.filter(function(e){return e.neighborhood==r});i(null,n)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(r,i,o){a.getRestaurants(function(e,t){if(e)o(e,null);else{var n=t;"all"!=r&&(n=n.filter(function(e){return e.cuisine_type==r})),"all"!=i&&(n=n.filter(function(e){return e.neighborhood==i})),o(null,n)}})}},{key:"fetchNeighborhoods",value:function(i){a.getRestaurants(function(e,n){if(e)i(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),t=r.filter(function(e,t){return r.indexOf(e)==t});i(null,t)}})}},{key:"fetchCuisines",value:function(i){a.getRestaurants(function(e,n){if(e)i(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),t=r.filter(function(e,t){return r.indexOf(e)==t});i(null,t)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"mdImageUrlForRestaurant",value:function(e){return isChrome?"./dist/img/"+e.id+"-md.webp":"./dist/img/"+e.id+"-md.jpg"}},{key:"smImageUrlForRestaurant",value:function(e){return isChrome?"./dist/img/"+e.id+"-sm.webp":"./dist/img/"+e.id+"-sm.jpg"}},{key:"mapMarkerForRestaurant",value:function(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:a.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}},{key:"toggleFavorite",value:function(r,i){fetch(a.DATABASE_URL+"/restaurants/"+r+"/?is_favorite="+i,{method:"put",headers:{Accept:"application/json","Content-Type":"application/json"}}).catch(function(){var t=a.openIDB();t.then(function(e){if(e)return e.transaction(DB_NAME,"readwrite").objectStore(DB_NAME).getAll()}).then(function(e){var n=e.filter(function(e){return e.id==r})[0];n.is_favorite=i,n.is_favorite_pending=!0,t.then(function(e){if(e){var t=e.transaction(DB_NAME,"readwrite");return t.objectStore(DB_NAME).put(n),t.complete}})})})}},{key:"storeReview",value:function(r,t){var e=a.openIDB();fetch(a.DATABASE_URL+"/reviews/",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({restaurant_id:r.restaurantId,name:r.name,rating:r.rating,comments:r.comments})}).then(function(e){return e.json()}).then(function(n){e.then(function(e){if(e){var t=e.transaction("reviews","readwrite");return t.objectStore("reviews").put(n),n.hasOwnProperty("random_id")&&a.deletePendingReviewFromIdb(n),t.complete,n}}).then(function(e){t(e)})}).catch(function(){e.then(function(e){if(e){var t=e.transaction("pending-reviews","readwrite"),n=t.objectStore("pending-reviews");return r.random_id=a.generateRandomId(),n.put(r),t.complete,r}}).then(function(e){t(e)})})}},{key:"submitRestaurantPendingFavorites",value:function(r){fetch(a.DATABASE_URL+"/restaurants/"+r.id+"/?is_favorite="+r.is_favorite,{method:"put",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){a.openIDB().then(function(e){if(e){var t=e.transaction(DB_NAME,"readwrite"),n=t.objectStore(DB_NAME);return r.is_favorite_pending=!1,n.put(r),t.complete}})})}},{key:"fetchReviewsByRestaurantId",value:function(i,n){var o=a.openIDB();fetch(a.DATABASE_URL+"/reviews?restaurant_id="+i.id).then(function(e){return e.json()}).then(function(r){o.then(function(e){if(e){var t=e.transaction("reviews","readwrite"),n=t.objectStore("reviews");return r.forEach(function(e){n.put(e)}),i.reviews=r,t.complete}}).then(function(){n()})}).catch(function(e){o.then(function(e){if(e)return e.transaction("reviews","readwrite").objectStore("reviews").getAll()}).then(function(e){var t=e.filter(function(e){return e.restaurant_id==i.id});i.reviews=t,o.then(function(e){if(e)return e.transaction("pending-reviews","readwrite").objectStore("pending-reviews").getAll()}).then(function(e){var t,n=e.filter(function(e){return e.restaurantId==i.id});(t=i.reviews).push.apply(t,_toConsumableArray(n))}).then(function(){n()})})})}},{key:"deletePendingReviewFromIdb",value:function(n){a.openIDB().then(function(e){if(e){var t=e.transaction("pending-reviews","readwrite");return t.objectStore("pending-reviews").delete(n.random_id),t.complete}})}},{key:"generateRandomId",value:function(){return"_"+Math.random().toString(24).substr(2,9)}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337"}}]),a}(),restaurant=void 0,reviewRating=raterJs({showToolTip:!1,max:5,starSize:18,element:document.querySelector("#rater"),rateCallback:function(e,t){this.setRating(e),t()}});reviewRating.setRating(1),window.fetchRestaurantFromURL=function(n){if(self.restaurant)n(null,self.restaurant);else{var e=getParameterByName("id");e?DBHelper.fetchRestaurantById(e,function(e,t){(self.restaurant=t)?(fillRestaurantHTML(),n(null,t)):console.error(e)}):(error="No restaurant id in URL",n(error,null))}},window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})},window.fillRestaurantHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;var t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.mdImageUrlForRestaurant(e),t.alt="Restaurant "+e.name,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),e&&DBHelper.fetchReviewsByRestaurantId(e,fillReviewsHTML)},window.fillRestaurantHoursHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.getElementById("restaurant-hours");for(var n in e){var r=document.createElement("tr"),i=document.createElement("td");i.innerHTML=n,r.appendChild(i);var o=document.createElement("td");o.innerHTML=e[n],r.appendChild(o),t.appendChild(r)}},window.fillReviewsHTML=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){var r=document.createElement("p");return r.innerHTML="No reviews yet!",void t.appendChild(r)}var i=document.getElementById("reviews-list");e.forEach(function(e){i.appendChild(createReviewHTML(e))}),t.appendChild(i)},window.createReviewHTML=function(e){var t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML="Rating: "+e.rating,t.appendChild(r);var i=document.createElement("p");return i.innerHTML=e.comments,t.appendChild(i),t},window.fillBreadcrumb=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},window.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};var reviewsForm=document.getElementById("review-form"),ul=document.getElementById("reviews-list");reviewsForm.addEventListener("submit",function(e){e.preventDefault();var t={restaurantId:getParameterByName("id",window.location),name:reviewsForm.elements.firstName.value,rating:reviewRating.getRating(),comments:reviewsForm.elements.comments.value};DBHelper.storeReview(t,function(e){ul.appendChild(createReviewHTML(e)),reviewsForm.reset()})});